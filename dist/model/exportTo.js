!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).exportFromJSON=e()}(this,function(){"use strict";function t(t,e){if("[object Array]"!==Object.prototype.toString.call(t))throw new Error(e)}function e(t){return Object.keys(t).map(function(e){return t[e]})}function n(t){return Object.keys(t)}function r(t){return Object.keys(t).map(function(e){return[e,t[e]]})}function o(t,e){var n="."+e,r=new RegExp("(\\"+e+")?$");return t.replace(/\s+/,"_").replace(r,n)}function a(t,e,n){void 0===n&&(n="download");var r=function(t,e){switch(e){case"txt":return"data:text/plain;charset=utf-8,"+encodeURIComponent(t);case"json":return"data:application/json;charset=utf-8,"+encodeURIComponent(t);case"csv":return"data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(t);case"xls":return"data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(t);default:return""}}(t,e),o=document.createElement("a");o.href=r,o.download=n,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function c(t){return t.map(r).reduce(function(e,n,r){return n.reduce(function(e,n){var o=n[0],a=n[1],c=e[o]||Array.from({length:t.length}).map(function(t){return""});return c[r]=("string"!=typeof a?JSON.stringify(a):a)||"",e[o]=c,e},e)},Object.create(null))}function u(t){return'\n    <html>\n      <head>\n        <meta charset="UTF-8">\n      </head >\n      <body>\n        '+(r=c(t),o=n(r),a=e(r).map(function(t){return t.map(function(t){return"<td>"+t+"</td>"})}).reduce(function(t,e){return t.map(function(t,n){return""+t+e[n]})}),"\n    <table>\n      <thead><tr><th><b>"+o.join("</b></th><th><b>")+"</b></th></tr></thead>\n      <tbody><tr>"+a.join("</tr><tr>")+"</tr></tbody>\n    </table>\n  ")+"\n      </body>\n    </html >\n  ";var r,o,a}function i(r){var i,d=r.data,s=r.fileName,f=void 0===s?"download":s,l=r.exportType,p=void 0===l?"txt":l,v=r.replacer,h=void 0===v?null:v,m=r.space,y=void 0===m?4:m,b=r.processor,x=void 0===b?a:b,j=r.withBOM,w=void 0!==j&&j,O="Invalid export data. Please provide an array of object",g="Can't export unknown data type "+p+".",C=function(t){try{return"string"==typeof t?JSON.parse(t):t}catch(t){throw new Error("Invalid export data. Please provide a valid JSON")}}(d),I=function(t,e,n){void 0===e&&(e=null);try{return JSON.stringify(t,e,n)}catch(t){throw new Error("Invalid export data. Please provide valid JSON object")}}(C,h,y);switch(p){case"txt":return x(I,p,o(f,"txt"));case"json":return x(I,p,o(f,"json"));case"csv":t(C,O);var N=n(i=c(C)).join(",")+"\r\n"+e(i).map(function(t){return t.map(function(t){return'"'+t.replace(/\"/g,'""')+'"'})}).reduce(function(t,e){return t.map(function(t,n){return t+","+e[n]})}).join("\r\n");return x(w?"\ufeff"+N:N,p,o(f,"csv"));case"xls":return t(C,O),x(u(C),p,o(f,"xls"));default:throw new Error(g)}}var d;return(d=i||(i={})).types={txt:"txt",json:"json",csv:"csv",xls:"xls"},d.processors={downloadFile:a},i});